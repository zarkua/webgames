## Сбор

Ищу музыку и звуки и кладу все в одну папку.


## Причесываем файлы

Какая проблема возникает с сотней скачанных файлов из разных источников? Они все имеют разные настройки и поэтому если включить их рядом  мозг будет сам пытаться нормализовать эти звуки и произойдет "ear fatigue" - звуковая усталость от игры. Поэтому для удобства привожу звуки к одному виду, тогда музыка будет перетекать плавно из трека в трек, а смешивать эффекты становится удобнее.

![Screenshot](1.png)
##### Начинаю с нормализации всех файлов.  

Ее существует два типа : 
- пиковая (просто поднимаем громкость всей дорожки пока не достигнет заданного нами значения) 
- RMS/LUFS/LKFS/dBFS (полная противоположность пиковой нормализации, проводится исходя из средней квадратичной громкости звукового участка)

Я использую второй вариант, он не так визуально явно работает как первый, но сильно приятней в конечном итоге. Отличие между аббревиатурами только в том какие циферки будете брать и что используется в вашей программе.

Привожу все данные, которыми пользуюсь:

- RMS финального микса голливудских саундтреков обычно не превышает -20 дБ, а некоторые даже не доходят до -24 дБ.（Современный мейнстрим находится на уровне -24 дБ LKFS).
- Выход встроенного динамика стандартных мобильных телефонов обрежет все, когда RMS звука превысит -8 дБ.
-  -23 LUFS было у Ryse: Son of Rome для Xbox One
- Bioshock Infinite: -11.8 LKFS
- Portal 2: -14.9 LKFS
- Tomb Raider: -16.7 LKFS
- The Walking Dead: -16.8 LKFS
- Arkham City: -17.1 LKFS
- Borderlands 2: -19.6 LKFS
- GTA IV: -20.6 LKFS
- Dishonored: -23.1 LKFS
- Skyrim: -26.0 LKFS

Что я использую:
- Музыка：-16 dB
- Ambience：-16 dB
- Диалоги: -12 dB
- SFX: -16 dB
- UI: -16 dB

Обычно зависит от проекта к проекту, например для веба легче всего выставить -16 dB всему т.к. музыка там отходит на второй план.

##### Диапазон громкости (Loudness Range)

Чем больше разница между громкостью на отдельных участках трека тем выше **Loudness Range**. 
![Screenshot](2.png)
Стандарты которые есть в играх:
- GTA IV: 18.3 LU
- The Walking Dead: 17.8 LU
- Skyrim: 17.3 LU
- Borderlands 2: 16.4 LU
- Tomb Raider: 14.9 LU
- Portal 2: 13.9 LU
- Bioshock Infinite: 13.2 LU
- Dishonored: 12.6 LU
- Arkham City: 10.6 LU

Стандарты от Wwise в зависимости от того где будут играть:

- Домашний кинотеатр: 20
- Гостинная: 18
- Кухня: 15
- Гостинная ночью:9
- В транспорте на мобиле: 6

Общее правило - чем громче будет среда где будут играть, тем можно делать ниже LR. 
Больше всего значение LR зависит от жанра игры и где в нее будут играть. 
Игра с низким уровнем LR и звуком -23LKFS может быть более утомительной, чем игра с более высоким уровнем громкости и большим LR. Если игра очень громкая, пользователь, скорее всего, уменьшит громкость и, наоборот, увеличит ее, если игра очень тихая. Если звук имеет небольшой динамический диапазон, он будет звучать чрезмерно сжатым и .


## Сортировка

Сортируем скачанное по пяти папкам которые называем Tier_1,Tier_2,Tier_3,Tier_4,Tier_5.
В эти папки кладет в зависимости от того насколько качественный он должен быть на выходе. В папку 1, например я кладу музыку, а в последнюю папку кладу самый ненужный звук в игре.

![Screenshot](3.png)
Теперь создаю батник, который в один клик преобразует файлы и запишет их всех в папку Finals:

``` powershell
@echo off

setlocal enabledelayedexpansion

REM Пути к папкам
set TIER_1=Tier_1
set TIER_2=Tier_2
set TIER_3=Tier_3
set TIER_4=Tier_4
set TIER_5=Tier_5
set FINAL=Final


for %%f in (%TIER_1%\*.*) do (
    ffmpeg -i "%%f" -c:a libvorbis -ab 128k -ar 44100 "%FINAL%\%%~nf.ogg"
)

for %%f in (%TIER_2%\*.*) do (
    ffmpeg -i "%%f" -c:a libvorbis -ab 128k -ar 32100 "%FINAL%\%%~nf.ogg"
)


for %%f in (%TIER_3%\*.*) do (
    ffmpeg -i "%%f" -c:a libvorbis -ab 112k -ar 32100 "%FINAL%\%%~nf.ogg"
)


for %%f in (%TIER_4%\*.*) do (
    ffmpeg -i "%%f" -c:a libvorbis -ab 96k -ar 22050 "%FINAL%\%%~nf.ogg"

)


for %%f in (%TIER_5%\*.*) do (
    ffmpeg -i "%%f" -ac 1 -c:a libvorbis -ab 64k -ar 16000 "%FINAL%\%%~nf.ogg" 
)

echo done.
pause

```

Сохраняем как convert_to_ogg_web.bat, если нужно будет сохранить для мобил или ПК я просто создаю новый батник с другими параметрами. В итоге у меня есть пять папок с оригинальными нормализованными звуковыми файлами большого размера и любого разрешения и папка Finals, где будут файлы оптимизированные для веба или мобил или любой другой платформы.






